
<div class="img-view-modal modal fade" id="commentModal" role="modal">
	<div class="modal-header">
		<button class="close" type="button" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title">Public Comment Count by Valued Component</h3>
	</div>
	<tmpl-public-comment-chart class="topic-cloud-container"
		x-refresh="s.refreshVisualization"
		x-data="s.commentsByTopicVis"
		id="publicCommentsByTopic">
	</tmpl-public-comment-chart>
</div>

<!-- Temporary fix until we move to angular modals -->
<div class="temp-overlay"></div>

<div class="clearfix">
	<div class="pull-left">
		<div ng-if="s.period.userCan.vetComments">
			<!-- PROTOTYPE EAO ROW TEMPLATES  -->
			<ul class="tab-container nav nav-pills" role="tablist">
				<li role="presentation" class="active"><a href ng-click="s.toggle('Unvetted')"  role="tab" data-toggle="tab">Pending Review ({{s.totalPending}})</a></li>
				<li role="presentation"><a href ng-click="s.toggle('Deferred')"  role="tab" data-toggle="tab">Deferred ({{s.totalDeferred}})</a></li>
				<li role="presentation"><a href ng-click="s.toggle('Published')" role="tab" data-toggle="tab">Published ({{s.totalPublic}})</a></li>
				<li role="presentation"><a href ng-click="s.toggle('Rejected')"  role="tab" data-toggle="tab">Rejected ({{s.totalRejected}})</a></li>
			</ul>
		</div>
		<div ng-if="s.period.userCan.classifyComments && !s.period.userCan.vetComments">
			<!-- PROPONENT TEMPLATES  -->
			<ul class="tab-container nav nav-pills" role="tablist">
				<li role="presentation" class="active"><a href role="tab" data-toggle="tab" ng-click="s.toggleP('Unclassified')">Unassigned ({{s.totalUnassigned}})</a></li>
				<li role="presentation"><a href role="tab" data-toggle="tab" ng-click="s.toggleP('Classified')">Assigned ({{s.totalAssigned}})</a></li>
			</ul>
		</div>
		<span class="pcp-comment-count-label" ng-if="!s.period.userCan.classifyComments && !s.period.userCan.vetComments">Total Comments ({{s.totalPublished}})</span>
	</div>
	<div class="actions pull-right">
		<button class="btn btn-default btn-sm" ng-if="s.showTopicCloud === false"
			data-toggle="modal"
			data-target="#commentModal"
			data-backdrop="false">Count by Valued Component</button>
		<button class="btn btn-default btn-sm" ng-if="authentication.user"
			ng-click="s.downloadCommentData()"><span class="glyphicon glyphicon-download-alt"></span><span>Download CSV</span></button>
	</div>
</div>

<div class="tab-pane">

	<div class="public-comment-panel panel panel-default">
		<table class="eao-comment-table table table-hover" st-pipe="s.callServer" st-table="s.displayed">
			<thead>
			<tr>
				<th ng-if="authentication.user" class="'id-col no-mobile'" st-sort="commentId" st-sort-default="reverse">ID</th>
				<th class="'comment no-mobile'" st-sort="comment">Posted by / Comment</th>
				<th class="'location-col no-mobile'" st-sort="location">Location</th>
				<th class="'pillar-col no-mobile'" st-sort="pillars">Pillars</th>
				<th class="'pillar-col no-mobile'" st-sort="topics">Valued Components</th>
				<th class="'attachment-col no-mobile'"></th>
				<th class="'attachment-col no-mobile'" st-sort="dateAdded">Date Posted</th>
			</tr>
			<!-- tr>
				<th ng-if="authentication.user"><input st-search="commentId"/></th>
				<th><input class="input-sm form-control" st-search="authorComment"/></th>
				<th><input class="input-sm form-control" st-search="location"/></th>
				<th>
					<select class="input-sm form-control" st-input-event="change" st-search="pillars">
						<option value=""></option>
						<option ng-repeat="option in s.pillarsArray" value="{{option.id}}">{{option.name}}</option>
					</select>
				</th>
				<th>
					<select class="input-sm form-control" st-input-event="change" st-search="topics">
						<option value=""></option>
						<option ng-repeat="option in s.topicsArray" value="{{option.id}}">{{option.name}}</option>
					</select>
				</th>
				<th></th>
				<th></th>
			</tr -->
			</thead>

			<tbody ng-show="!s.isLoading">
			<tr class="comment-row clickable"  ng-repeat="o in s.displayed" ng-click="s.detail(o)">
				<td class="id-col no-mobile" ng-if="authentication.user">
					{{ ::o.commentId }}
				</td>
				<td class="comment-col">
					<h2 ng-if="::o.isAnonymous" class="comment-title">Anonymous</h2>
					<h2 ng-if="::!o.isAnonymous" class="comment-title">{{ ::o.author }}</h2>
					<div ng-if="o.comment" ng-init="toggleProject.desc = (false)">
						<p class="comment">{{ ::o.comment | maxWords: 20 }}</p>
					</div>
				</td>
				<td class="location-col no-mobile">
					{{ ::o.location }}
				</td>
				<td class="pillar-col">
					<span class="tag-list">{{o.pillars.join (', ')}}</span>
				</td>
				<td class="vc-col">
					<span class="tag-list">{{o.topics.join (', ')}}</span>
				</td>
				<td class="attachment-col">
					<span class="glyphicon glyphicon-paperclip" ng-if="o.publishedDocumentCount > 0" title="{{o.publishedDocumentCount}} attachments available"></span>
				</td>
				<td class="date-col">
					{{o.dateAdded | date:'MMM dd, yyyy @ h:mm a'}}
				</td>
			</tr>
			<tr class="no-records" ng-if="!s.displayed || s.displayed.length === 0">
				<td colspan="{{s.colspan}}">No records found.</td>
			</tr>
			</tbody>

			<tbody ng-show="s.isLoading">
			<tr>
				<td colspan="{{s.colspan}}" class="text-center">Loading ... </td>
			</tr>
			</tbody>

			<tfoot>
			<tr>
				<td class="text-left" st-pagination="" st-items-by-page="s.pageSize" colspan="{{s.colspan - 3}}" st-template="modules/core/client/views/st-template.html">
				</td>
				<td class="text-right" colspan="3">
					<ul class="pagination">
						<li ng-class="{active: s.pageSize==10}">
							<a ng-click="s.changePageSize(10)">10</a>
						</li>
						<li ng-class="{active: s.pageSize==20}">
							<a ng-click="s.changePageSize(20)">20</a>
						</li>
						<li ng-class="{active: s.pageSize==50}">
							<a ng-click="s.changePageSize(50)">50</a>
						</li>
						<li ng-class="{active: s.pageSize==100}">
							<a ng-click="s.changePageSize(100)">100</a>
						</li>

					</ul>
				</td>
			</tr>
			</tfoot>

		</table>
	</div>
</div>
<!-- / EAO ROW TEMPLATES  -->

